{
  "hash": "86e8256336e40dab83a9f1b723625b05",
  "result": {
    "markdown": "---\ntitle: \"Masa para Pizza\"\nauthor: \"Miguel Equihua\"\ndate: \"2023-02-06\"\noutput: html_document\n---\n\n\n\n\n## Exploración tabular de los datos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nmasa <- read_csv(\"masa-para-pizza.txt\", col_names = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 16 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): receta\ndbl (1): tiempo\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nmasa %>% mutate(receta = factor(receta)) -> masa\n\nmasa %>% group_by(receta) %>% \n         summarise(media = median(tiempo, na.rm = TRUE), \n                   mediana = median(tiempo, na.rm = TRUE),\n                   var = var(tiempo))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 × 4\n  receta media mediana   var\n  <fct>  <dbl>   <dbl> <dbl>\n1 A       488.    488. 6340.\n2 B       192.    192. 4490.\n3 C       675     675  5491.\n4 D       175     175  2723.\n```\n:::\n\n```{.r .cell-code}\nmasa <- masa[order(masa$receta),]\n```\n:::\n\n\n## Exploración gráfica\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(masa$tiempo, type = \"n\", ylab = \"tiempo\")\ntext(masa$tiempo, labels = masa$receta)\n```\n\n::: {.cell-output-display}\n![](masa-pizza_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmasa_lm <- lm(tiempo ~ receta, data = masa)\nsummary(masa_lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = tiempo ~ receta, data = masa)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-102.000  -39.375    3.875   49.000   88.750 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   486.25      34.50  14.095 7.90e-09 ***\nrecetaB      -290.00      48.79  -5.944 6.78e-05 ***\nrecetaC       169.75      48.79   3.479  0.00455 ** \nrecetaD      -302.50      48.79  -6.200 4.59e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 69 on 12 degrees of freedom\nMultiple R-squared:  0.9179,\tAdjusted R-squared:  0.8974 \nF-statistic: 44.74 on 3 and 12 DF,  p-value: 8.64e-07\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(masa_lm)\n```\n\n::: {.cell-output-display}\n![](masa-pizza_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](masa-pizza_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](masa-pizza_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](masa-pizza_files/figure-html/unnamed-chunk-4-4.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nconfint(masa_lm, level = 0.95)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 2.5 %    97.5 %\n(Intercept)  411.08342  561.4166\nrecetaB     -396.30159 -183.6984\nrecetaC       63.44841  276.0516\nrecetaD     -408.80159 -196.1984\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmasa$receta_ABD <- recode(masa$receta, A = \"ABD\", B =\"ABD\", D = \"ABD\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmasa_lm_ABD <- lm(tiempo ~ receta_ABD, data = masa)\nsummary(masa_lm_ABD)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = tiempo ~ receta_ABD, data = masa)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-168.75 -104.94  -23.75   74.56  286.25 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   288.75      41.65   6.932 6.96e-06 ***\nreceta_ABDC   367.25      83.31   4.408 0.000595 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 144.3 on 14 degrees of freedom\nMultiple R-squared:  0.5813,\tAdjusted R-squared:  0.5514 \nF-statistic: 19.43 on 1 and 14 DF,  p-value: 0.0005951\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(masa_lm_ABD)\n```\n\n::: {.cell-output-display}\n![](masa-pizza_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](masa-pizza_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](masa-pizza_files/figure-html/unnamed-chunk-8-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](masa-pizza_files/figure-html/unnamed-chunk-8-4.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modelo asumiendo heterocedasticidad\n# Defino los ponderadores a usar\nwt <- 1 / lm(abs(masa_lm$residuals) ~ masa_lm$fitted.values)$fitted.values^2\nmasa_lm_ABD_pond <- lm(log(tiempo) ~ receta_ABD, data = masa, weights = wt)\nsummary(masa_lm_ABD_pond)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = log(tiempo) ~ receta_ABD, data = masa, weights = wt)\n\nWeighted Residuals:\n       Min         1Q     Median         3Q        Max \n-0.0144840 -0.0042887  0.0005512  0.0050758  0.0162045 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   5.4644     0.1327  41.170 5.21e-16 ***\nreceta_ABDC   1.0167     0.3105   3.275  0.00553 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.009401 on 14 degrees of freedom\nMultiple R-squared:  0.4337,\tAdjusted R-squared:  0.3933 \nF-statistic: 10.72 on 1 and 14 DF,  p-value: 0.005534\n```\n:::\n\n```{.r .cell-code}\nplot((masa_lm_ABD_pond))\n```\n\n::: {.cell-output-display}\n![](masa-pizza_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](masa-pizza_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](masa-pizza_files/figure-html/unnamed-chunk-9-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](masa-pizza_files/figure-html/unnamed-chunk-9-4.png){width=672}\n:::\n:::\n",
    "supporting": [
      "masa-pizza_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}