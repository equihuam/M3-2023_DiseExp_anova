<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Miguel Equihua">
<meta name="author" content="Alan Aguirre">

<title>Curso de Estadística - Experimentos completamente aleatorizados</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/bar-chart.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Curso de Estadística</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">Acerca del módulo III</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/equihuam/M3-2023_DiseExp_anova"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Experimentos completamente aleatorizados</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">clase</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Autores/as</div>
      <div class="quarto-title-meta-contents">
               <p>Miguel Equihua </p>
               <p>Alan Aguirre </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Fecha de publicación</div>
      <div class="quarto-title-meta-contents">
        <p class="date">30 de enero de 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p><img src="maíz.jpg" class="img-fluid" width="400"></p>
<section id="diseño-completamente-aleatorizado" class="level1">
<h1>Diseño completamente aleatorizado</h1>
<section id="respuesta-de-cultivares-a-fertilizantes-glex1" class="level2">
<h2 class="anchored" data-anchor-id="respuesta-de-cultivares-a-fertilizantes-glex1">Respuesta de Cultivares a fertilizantes (GLEX1)</h2>
<p>Ejemplo tomado de Crawley (1998). <strong>Glim for Ecologists</strong>. Oxford. UK.</p>
<p>Es un experimento en el que se midió el crecimiento (masa seca al cosechar = <em>y</em>) de plantas tratadas con 10 concentraciones diferentes de suplemento mineral como fertilizante, <em>f</em>. El experimento fue realizado con dos cultivares diferentes, <em>g</em>. Uno fue clonado de plantas de un ambiente árido y el otro de uno húmedo. Todas las plantas de cada tipo, sin restricciones, fueron asignadas aleatoriamente a los distintos niveles de fertilizante.</p>
<p>leer lista de archivos en un directorio</p>
<section id="lectura-de-datos" class="level3">
<h3 class="anchored" data-anchor-id="lectura-de-datos">Lectura de datos</h3>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>RutaCrawley <span class="ot">&lt;-</span><span class="st">"../../../Crawley/"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>GLEX1 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="fu">paste0</span>(RutaCrawley, <span class="st">"GLEX1.DAT"</span>),</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"fertilizante"</span>, <span class="st">"rendimiento_peso"</span>)) </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(GLEX1)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  fertilizante rendimiento_peso
1            1           2.8215
2            2           2.3590
3            3           3.0912
4            4           2.5297
5            5           3.4753
6            6           3.6493</code></pre>
</div>
</div>
<p>A veces hay archivos que contienen datos faltantes o perdidos. Podemos enfrentar eso con la función <code>complete.cases()</code> que revisa linea por linea el archivo y regresa “verdadero” si todas las columnas tienen datos válidos y “falso”. Esta lista de “verdaderos” y “falsos” la podemos usar para elegir que filas del archivo de datos están completas y así podemos eliminarlas del conjunto de datos que vamos a procesar.</p>
<p>Sobre los datos limpios, generamos la variable indicativa del tipo de ambiente del que se tomo la planta que se clonó.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># En caso de que haya datos extra, elimino registros leidos como datos erróneos</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>GLEX1 <span class="ot">&lt;-</span> GLEX1[<span class="fu">complete.cases</span>(GLEX1), ]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="genera-los-factores-genotipo-y-fertilizante" class="level3">
<h3 class="anchored" data-anchor-id="genera-los-factores-genotipo-y-fertilizante">Genera los factores genotipo y fertilizante</h3>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>GLEX1<span class="sc">$</span>cultivar <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"seco"</span>,<span class="st">"humedo"</span>), <span class="at">each=</span><span class="dv">10</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>GLEX1<span class="sc">$</span>fertilizante <span class="ot">&lt;-</span> <span class="fu">factor</span>(GLEX1<span class="sc">$</span>fertilizante) </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(GLEX1)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  fertilizante rendimiento_peso cultivar
1            1           2.8215     seco
2            2           2.3590     seco
3            3           3.0912     seco
4            4           2.5297     seco
5            5           3.4753     seco
6            6           3.6493     seco</code></pre>
</div>
</div>
</section>
<section id="gráfica-de-masa-seca-contra-fertilizante-mineral---sin-diferenciar-tratamientos" class="level3">
<h3 class="anchored" data-anchor-id="gráfica-de-masa-seca-contra-fertilizante-mineral---sin-diferenciar-tratamientos">gráfica de masa seca contra fertilizante mineral - sin diferenciar tratamientos</h3>
<p>Veamos los datos en una gráfica simple. La función plot hace cosas distintas según el tipo de datos que le demos. Para generar la gráfica simple que queremos aquí, conviene que los valores de fertilizante sean interpretados como valores numéricos. Esto lo logramos con la funnción <code>as.numeric</code></p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.numeric</span>(GLEX1<span class="sc">$</span>fertilizante), GLEX1<span class="sc">$</span>rendimiento_peso, <span class="at">xlab=</span><span class="st">"fertilizante"</span>, <span class="at">ylab=</span><span class="st">"biomasa"</span>, <span class="at">type=</span><span class="st">"p"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Para explorar mejor los datos podemos marcar en la gráfica las obsevaciones que pertenecen a cada condición. En este caso, te propongo poner el nobre que le dimos al “tratamiento”.</p>
<p>Gráfica de masa seca contra fertilizante mineral diferenciando por genotipos</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.numeric</span>(GLEX1<span class="sc">$</span>fertilizante), </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>     GLEX1<span class="sc">$</span>rendimiento_peso, <span class="at">xlab=</span><span class="st">"fertilizante"</span>, <span class="at">ylab=</span><span class="st">"biomasa"</span>, <span class="at">type=</span><span class="st">"n"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (GLEX1<span class="sc">$</span>fertilizante, GLEX1<span class="sc">$</span>rendimiento_peso, <span class="at">labels=</span>GLEX1<span class="sc">$</span>cultivar)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Podemos calcular ver las características estadísticas de lo que pasa con la biomasa que produce cada genotipo</p>
</section>
<section id="resumen-de-los-datos-de-masa-por-genotipo" class="level3">
<h3 class="anchored" data-anchor-id="resumen-de-los-datos-de-masa-por-genotipo">Resumen de los datos de masa por genotipo</h3>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span> (GLEX1, GLEX1<span class="sc">$</span>cultivar, summary)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>GLEX1$cultivar: humedo
  fertilizante rendimiento_peso   cultivar 
 1      :1     Min.   : 4.405   humedo:10  
 2      :1     1st Qu.: 5.617   seco  : 0  
 3      :1     Median : 8.592              
 4      :1     Mean   : 8.716              
 5      :1     3rd Qu.:10.977              
 6      :1     Max.   :14.502              
 (Other):4                                 
------------------------------------------------------------ 
GLEX1$cultivar: seco
  fertilizante rendimiento_peso   cultivar 
 1      :1     Min.   : 2.359   humedo: 0  
 2      :1     1st Qu.: 2.889   seco  :10  
 3      :1     Median : 3.562              
 4      :1     Mean   : 4.866              
 5      :1     3rd Qu.: 6.355              
 6      :1     Max.   :10.130              
 (Other):4                                 </code></pre>
</div>
</div>
<p>Ahora podemos realizar el análisis estadístico mediante modelos. Hagamos ahora un análisis con el enfoque “tradicional” en <strong>R</strong>. Lo primero que haremos es configurar el entorno de análisis, esto significa elegir el tipo de contrastes que queremos operar al ajustar modelos <em>reparametrizados</em>. Haremos esto con opción <em>contrasts</em> en la función <code>options(contrasts=...)</code></p>
<p>Para asegurarnos de que los estimadores del modelo toman el primer nivel como referencia hay que usar el modo de reparametrización “treatment”. Hay otras formas de reparametrización, como podrás ver en la ayuda de <code>contr.treatment</code>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts=</span><span class="fu">c</span>(<span class="st">"contr.treatment"</span>, <span class="st">"contr.poly"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="ajusta-modelo-nulo---sólo-la-media" class="level3">
<h3 class="anchored" data-anchor-id="ajusta-modelo-nulo---sólo-la-media">ajusta modelo nulo - sólo la media</h3>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>aj1 <span class="ot">&lt;-</span> <span class="fu">lm</span> (rendimiento_peso <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> GLEX1)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aj1)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = rendimiento_peso ~ 1, data = GLEX1)

Residuals:
   Min     1Q Median     3Q    Max 
-4.432 -3.185 -1.006  2.555  7.711 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   6.7912     0.8067   8.419 7.79e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.608 on 19 degrees of freedom</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Agregamos el efecto del fertilizante</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>aj2 <span class="ot">&lt;-</span> <span class="fu">update</span>(aj1, .<span class="sc">~</span> . <span class="sc">+</span> fertilizante)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(aj2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: rendimiento_peso
             Df Sum Sq Mean Sq F value Pr(&gt;F)
fertilizante  9 142.75  15.861  1.5174 0.2622
Residuals    10 104.53  10.453               </code></pre>
</div>
</div>
<p>Nótese que el número de niveles de fertilizante es 10, así que los grados de libertad son 10-1=9. De modo semejante el número de observaciones es 20, así que los grados de libertad del residuo descuenta los grados de libertad del fertilizante y 1 (por la estimación de la media general): 20 - 9 - 1 = 10</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># agregamos el cultivar</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>aj3 <span class="ot">&lt;-</span> <span class="fu">update</span>(aj2,  .<span class="sc">~</span> . <span class="sc">+</span> cultivar)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(aj3)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: rendimiento_peso
             Df  Sum Sq Mean Sq F value   Pr(&gt;F)   
fertilizante  9 142.747  15.861  4.6953 0.015392 * 
cultivar      1  74.125  74.125 21.9434 0.001145 **
Residuals     9  30.402   3.378                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Podemos intentar hacer un modelo completo, es decir con todos los posibles factores y combinaciones que pueden producirse. Sin embargo este modelo consume todos los grados de liberta (observacione) con que contamos. De todos modos lo podemos intentar para ver que nos dice <strong>R</strong>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># agregamos una pendiente diferente para cada genotipo</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>aj4 <span class="ot">&lt;-</span> <span class="fu">update</span>(aj3,  .<span class="sc">~</span> . <span class="sc">+</span> cultivar<span class="sc">:</span>fertilizante)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(aj4)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in anova.lm(aj4): ANOVA F-tests on an essentially perfect fit are
unreliable</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: rendimiento_peso
                      Df  Sum Sq Mean Sq F value Pr(&gt;F)
fertilizante           9 142.747  15.861     NaN    NaN
cultivar               1  74.125  74.125     NaN    NaN
fertilizante:cultivar  9  30.402   3.378     NaN    NaN
Residuals              0   0.000     NaN               </code></pre>
</div>
</div>
<p>La scuencia de ajustes produce estos cambios en devianza</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(aj1, aj2, aj3)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: rendimiento_peso ~ 1
Model 2: rendimiento_peso ~ fertilizante
Model 3: rendimiento_peso ~ fertilizante + cultivar
  Res.Df     RSS Df Sum of Sq       F   Pr(&gt;F)   
1     19 247.274                                 
2     10 104.527  9   142.747  4.6953 0.015392 * 
3      9  30.402  1    74.125 21.9434 0.001145 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="modelo-mínimo-adecuado" class="level3">
<h3 class="anchored" data-anchor-id="modelo-mínimo-adecuado">Modelo mínimo adecuado</h3>
<p>estos resultados sugieren que el modelo 3 es mínimo adecuado resumen del modelo mínimo adecuado</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aj3)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = rendimiento_peso ~ fertilizante + cultivar, data = GLEX1)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.6653 -0.7855  0.0000  0.7855  2.6653 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)      5.9538     1.3630   4.368  0.00180 **
fertilizante2   -0.1251     1.8379  -0.068  0.94720   
fertilizante3    0.5784     1.8379   0.315  0.76014   
fertilizante4   -0.5614     1.8379  -0.305  0.76695   
fertilizante5    3.1205     1.8379   1.698  0.12376   
fertilizante6    2.3383     1.8379   1.272  0.23518   
fertilizante7    3.3713     1.8379   1.834  0.09981 . 
fertilizante8    5.7776     1.8379   3.144  0.01186 * 
fertilizante9    5.8829     1.8379   3.201  0.01082 * 
fertilizante10   7.2434     1.8379   3.941  0.00340 **
cultivarseco    -3.8503     0.8219  -4.684  0.00115 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.838 on 9 degrees of freedom
Multiple R-squared:  0.8771,    Adjusted R-squared:  0.7404 
F-statistic:  6.42 on 10 and 9 DF,  p-value: 0.004992</code></pre>
</div>
</div>
<p>Para comprender con exactitud que es lo que hace exactamente <strong>R</strong> al ajustar un modelo de regresión o ANDEVA, como este podemos usar la función <code>model.matrix()</code> aplicada al modelo que nos interese analizar. En este caso lo ejemplificaré con el modelo mínimo adecuado aj3. Así podemos ver en acción el uso de las formas de reparametrización</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(aj3)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept) fertilizante2 fertilizante3 fertilizante4 fertilizante5
1            1             0             0             0             0
2            1             1             0             0             0
3            1             0             1             0             0
4            1             0             0             1             0
5            1             0             0             0             1
6            1             0             0             0             0
7            1             0             0             0             0
8            1             0             0             0             0
9            1             0             0             0             0
10           1             0             0             0             0
11           1             0             0             0             0
12           1             1             0             0             0
13           1             0             1             0             0
14           1             0             0             1             0
15           1             0             0             0             1
16           1             0             0             0             0
17           1             0             0             0             0
18           1             0             0             0             0
19           1             0             0             0             0
20           1             0             0             0             0
   fertilizante6 fertilizante7 fertilizante8 fertilizante9 fertilizante10
1              0             0             0             0              0
2              0             0             0             0              0
3              0             0             0             0              0
4              0             0             0             0              0
5              0             0             0             0              0
6              1             0             0             0              0
7              0             1             0             0              0
8              0             0             1             0              0
9              0             0             0             1              0
10             0             0             0             0              1
11             0             0             0             0              0
12             0             0             0             0              0
13             0             0             0             0              0
14             0             0             0             0              0
15             0             0             0             0              0
16             1             0             0             0              0
17             0             1             0             0              0
18             0             0             1             0              0
19             0             0             0             1              0
20             0             0             0             0              1
   cultivarseco
1             1
2             1
3             1
4             1
5             1
6             1
7             1
8             1
9             1
10            1
11            0
12            0
13            0
14            0
15            0
16            0
17            0
18            0
19            0
20            0
attr(,"assign")
 [1] 0 1 1 1 1 1 1 1 1 1 2
attr(,"contrasts")
attr(,"contrasts")$fertilizante
[1] "contr.treatment"

attr(,"contrasts")$cultivar
[1] "contr.treatment"</code></pre>
</div>
</div>
</section>
<section id="crítica-al-modelo-y-recursos-diagnósticos" class="level3">
<h3 class="anchored" data-anchor-id="crítica-al-modelo-y-recursos-diagnósticos">crítica al modelo y recursos diagnósticos</h3>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(aj3)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="comparación-de-medias" class="level1">
<h1>Comparación de medias</h1>
<p>GLEX11 (p.&nbsp;138) Proteina y alcaloide. Se midió el incremento en longitud (mm) de larvas de insectos. Se hicieron mediciones después de dos semanas de alimentarlas con una dieta artificial bajo condiciones controladas de temperatura. Uno de los factores fue la cantidad de proteina en la dieta, con tres niveles (bajo, medio, alto). El otro factor es la presencia o ausencia de un alcaloide. Cada tratamiento se repitió cuatro veces. La asignación de los tratamientos a los insectos se hizo en forma aleatoria entre todos los especímenes disponibles.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lectura de datos</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>GLEX11 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="fu">paste0</span>(RutaCrawley, <span class="st">"GLEX11.DAT"</span>),</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"talla"</span>, <span class="st">"proteina"</span>, <span class="st">"alcaloide"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Uso la función "ordered" que genera factores ordenados, para evitar el que en el </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># despliegue de gráficas y otros resultados, S-Plus use el orden alfabético como arreglo.</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>GLEX11<span class="sc">$</span>proteina <span class="ot">&lt;-</span> <span class="fu">ordered</span>(GLEX11<span class="sc">$</span>proteina, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="fu">c</span>(<span class="st">"bajo"</span>, <span class="st">"medio"</span>, <span class="st">"alto"</span>))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>GLEX11<span class="sc">$</span>alcaloide <span class="ot">&lt;-</span><span class="fu">factor</span>(GLEX11<span class="sc">$</span>alcaloide, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="fu">c</span>(<span class="st">"ausente"</span>, <span class="st">"presente"</span>))</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Para simplificar el acceso a los datos uso la función attach</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(GLEX11)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co"># exploración de medias</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(<span class="fu">list</span>(<span class="at">talla=</span>talla), <span class="fu">list</span>(<span class="at">proteina=</span>proteina), mean)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  proteina talla
1     bajo  5.50
2    medio  5.25
3     alto  4.25</code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(<span class="fu">list</span>(<span class="at">talla=</span>talla), <span class="fu">list</span>(<span class="at">alcaloide=</span>alcaloide),mean)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  alcaloide talla
1   ausente   4.5
2  presente   5.5</code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(talla, <span class="fu">list</span>(proteina, alcaloide), mean)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      ausente presente
bajo      4.5      6.5
medio     3.5      7.0
alto      5.5      3.0</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Genero una table resumen de promedios. </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>GLEX11.res<span class="ot">&lt;-</span><span class="fu">aggregate</span>(<span class="fu">list</span>(<span class="at">talla=</span>talla), </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">list</span>(<span class="at">proteina=</span>proteina,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alcaloide=</span>alcaloide), mean)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">#exploración de varianzas </span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(<span class="fu">list</span>(<span class="at">talla=</span>talla),</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">list</span>(<span class="at">proteina=</span>proteina),var) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  proteina    talla
1     bajo 2.571429
2    medio 4.500000
3     alto 3.357143</code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(<span class="fu">list</span>(<span class="at">talla=</span>talla), </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">list</span>(<span class="at">alcaloide=</span>alcaloide), var) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  alcaloide    talla
1   ausente 2.090909
2  presente 4.636364</code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(talla, <span class="fu">list</span>(proteina, alcaloide), var)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       ausente  presente
bajo  1.666667 1.6666667
medio 1.666667 0.6666667
alto  1.666667 2.0000000</code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar talla contra proteina separada por alcaloide</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction.plot</span>(proteina, alcaloide, talla) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#args(interaction.plot)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste de modelos</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>larvas.nulo <span class="ot">&lt;-</span> <span class="fu">lm</span>(talla <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span>GLEX11)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># defino una simple función que extrae devianza y df de un ajuste y lo despliga</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co"># mediante la función "cat"</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>devianza <span class="ot">&lt;-</span> <span class="cf">function</span>(x) </span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  { <span class="fu">cat</span>(<span class="st">"devianza="</span>, <span class="fu">deviance</span>(x), <span class="st">"</span><span class="sc">\n</span><span class="st">df="</span>,x<span class="sc">$</span>df.residual,<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)}</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="co"># devianza del modelo nulo</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="fu">devianza</span>(larvas.nulo)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>devianza= 80 
df= 23 </code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># modelo completo</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>larvas.completo <span class="ot">&lt;-</span> <span class="fu">update</span>(larvas.nulo, . <span class="sc">~</span> . <span class="sc">+</span> proteina <span class="sc">+</span> alcaloide <span class="sc">+</span> proteina<span class="sc">:</span>alcaloide) </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">devianza</span>(larvas.completo) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>devianza= 28 
df= 18 </code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(larvas.completo)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 (Intercept)                   proteina.L 
                   4.5000000                    0.7071068 
                  proteina.Q            alcaloidepresente 
                   1.2247449                    1.0000000 
proteina.L:alcaloidepresente proteina.Q:alcaloidepresente 
                  -3.1819805                   -3.0618622 </code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># otra forma de escribir el modelo completo</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>larvas.completo <span class="ot">&lt;-</span> <span class="fu">update</span>(larvas.nulo, . <span class="sc">~</span> . <span class="sc">+</span> proteina <span class="sc">*</span> alcaloide) </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">devianza</span>(larvas.completo) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>devianza= 28 
df= 18 </code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(larvas.completo)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 (Intercept)                   proteina.L 
                   4.5000000                    0.7071068 
                  proteina.Q            alcaloidepresente 
                   1.2247449                    1.0000000 
proteina.L:alcaloidepresente proteina.Q:alcaloidepresente 
                  -3.1819805                   -3.0618622 </code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ¿Significancia de los términos?</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(larvas.completo)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: talla
                   Df Sum Sq Mean Sq F value    Pr(&gt;F)    
proteina            2      7  3.5000  2.2500 0.1342177    
alcaloide           1      6  6.0000  3.8571 0.0651695 .  
proteina:alcaloide  2     39 19.5000 12.5357 0.0003888 ***
Residuals          18     28  1.5556                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ¿Son necesarios todos los niveles de los factores? -- Comparaciones múltiples</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(larvas.completo)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = talla ~ proteina + alcaloide + proteina:alcaloide, 
    data = GLEX11)

Residuals:
   Min     1Q Median     3Q    Max 
-1.500 -1.000  0.000  0.625  2.000 

Coefficients:
                             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                    4.5000     0.3600  12.499 2.61e-10 ***
proteina.L                     0.7071     0.6236   1.134  0.27172    
proteina.Q                     1.2247     0.6236   1.964  0.06517 .  
alcaloidepresente              1.0000     0.5092   1.964  0.06517 .  
proteina.L:alcaloidepresente  -3.1820     0.8819  -3.608  0.00201 ** 
proteina.Q:alcaloidepresente  -3.0619     0.8819  -3.472  0.00272 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.247 on 18 degrees of freedom
Multiple R-squared:   0.65, Adjusted R-squared:  0.5528 
F-statistic: 6.686 on 5 and 18 DF,  p-value: 0.001103</code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generación de un factor re-codificado: tomaré: bame = bajo y medio, alto=alto</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Por supuesto hay que considerar que esta fusión tenga sentido biológico.</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Así podemos recodificar el factor proteina.</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(GLEX11)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>GLEX11<span class="sc">$</span>proteinaBM <span class="ot">&lt;-</span> GLEX11<span class="sc">$</span>proteina </span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(GLEX11<span class="sc">$</span>proteinaBM) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"bame"</span>, <span class="st">"bame"</span>, <span class="st">"alto"</span>) <span class="co"># cuidar el orden</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(GLEX11)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="co"># nuevo ajuste de modelo completo con el factor proteina recodificado.</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>larvas.protBM <span class="ot">&lt;-</span> <span class="fu">lm</span>(talla <span class="sc">~</span> proteinaBM <span class="sc">*</span> alcaloide, <span class="at">data =</span> GLEX11) </span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(larvas.protBM)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = talla ~ proteinaBM * alcaloide, data = GLEX11)

Residuals:
   Min     1Q Median     3Q    Max 
    -2     -1      0      1      2 

Coefficients:
                               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                      4.7500     0.3781  12.562 6.03e-11 ***
proteinaBM.L                     1.0607     0.5347   1.984   0.0612 .  
alcaloidepresente                0.1250     0.5347   0.234   0.8175    
proteinaBM.L:alcaloidepresente  -3.7123     0.7562  -4.909 8.47e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.235 on 20 degrees of freedom
Multiple R-squared:  0.6188,    Adjusted R-squared:  0.5616 
F-statistic: 10.82 on 3 and 20 DF,  p-value: 0.000194</code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ¿qué significancia tiene este cambio en el modelo?</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(larvas.protBM,larvas.completo) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: talla ~ proteinaBM * alcaloide
Model 2: talla ~ proteina + alcaloide + proteina:alcaloide
  Res.Df  RSS Df Sum of Sq      F Pr(&gt;F)
1     20 30.5                           
2     18 28.0  2       2.5 0.8036 0.4632</code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(larvas.protBM) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-18-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-18-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-18-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(GLEX11<span class="sc">$</span>talla, <span class="fu">list</span>(GLEX11<span class="sc">$</span>proteinaBM, GLEX11<span class="sc">$</span>alcaloide), mean) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     ausente presente
bame     4.0     6.75
alto     5.5     3.00</code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>GLEX11.resBM <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(<span class="fu">list</span>(<span class="at">talla =</span> talla), </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">list</span>(<span class="at">proteinaBM=</span> proteinaBM, </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">alcaloide =</span> alcaloide), mean)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction.plot</span>(proteinaBM,alcaloide,talla)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-18-6.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Con base en estos análisis ¿Cual es el modelo mínimo adecuado?</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># "suelto" los datos de la tabla GLEX11</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(GLEX11)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>